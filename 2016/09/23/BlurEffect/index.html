<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>iOS模糊效果(毛玻璃效果)的实现 | 所念皆星辰 | 踏实、低调、前行。</title>

  
  <meta name="author" content="Wheat">
  

  
  <meta name="description" content="简单的一个技术博客，用来作为学习笔记和日常记录使用。">
  

  
  
  <meta name="keywords" content="毛玻璃效果">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="iOS模糊效果(毛玻璃效果)的实现"/>

  <meta property="og:site_name" content="所念皆星辰"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="所念皆星辰" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">所念皆星辰</a>
    </h1>
    <p class="site-description">踏实、低调、前行。</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>iOS模糊效果(毛玻璃效果)的实现</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2016/09/23/BlurEffect/" rel="bookmark">
        <time class="entry-date published" datetime="2016-09-23T02:42:42.000Z">
          2016-09-23
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>　前一段时间项目中用到毛玻璃效果，那时对<code>UIBlurEffect</code>类和 <code>UIVisualEffectView</code>这两个类做了一部分了解。但当时并没有去特别的深入研究，直到项目做完后，才静下心来好好研究了一番。记录一下。</p>
<p>　　iOS8之后，Apple新添加<code>UIBlurEffect</code>类、<code>UIVibrancyEffect</code>类 和 <code>UIVisualEffectView</code>类这三种类，用途就是对背景色进行模糊化，也就是我们称的 “毛玻璃效果”。接下来就对具体的使用做一下分析吧。</p>
<p>　　其实细看下来，Apple对这种特效封装的很好，所以我们使用起来的并不需要什么步骤。不得不佩服Apple的强大啊。</p>
<p>1、关于<code>UIBlurEffect</code>类</p>
<p>我们首先看UIBlurEffect类，Apple文档中只给出了一个方法：</p>
<p>`</p>
<ul>
<li>(UIBlurEffect *)effectWithStyle:(UIBlurEffectStyle)style;<br>`<br>我们实现也是这样：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> *   模糊效果的三种风格</span><br><span class="line"> *</span><br><span class="line"> *  @param UIBlurEffectStyle</span><br><span class="line">   UIBlurEffectStyleExtraLight,//额外亮度，（高亮风格）</span><br><span class="line">   UIBlurEffectStyleLight,//亮风格</span><br><span class="line">   UIBlurEffectStyleDark//暗风格</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">//实现模糊效果</span><br><span class="line">UIBlurEffect *blurEffrct =[UIBlurEffect effectWithStyle:UIBlurEffectStyleLight];</span><br></pre></td></tr></table></figure>
<p> 2、关于<code>UIVibrancyEffect</code>类</p>
<p>文档中给出的也是一个方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (UIVibrancyEffect *)effectForBlurEffect:(UIBlurEffect *)blurEffect;</span><br></pre></td></tr></table></figure>
<p>官方给出的解释是这样的</p>
<blockquote>
<p>UIVibrancyEffect amplifies and adjusts the color of content layered behind the view, allowing content placed inside the contentView to become more vivid.</p>
<p>It is intended to be placed over, or as a subview of, a UIVisualEffectView that has been configured with a UIBlurEffect.</p>
<p>This effect only affects content added to the contentView. Because the vibrancy effect is color dependent, subviews added to the contentView need to be tintColorDidChange aware and must be prepared to update themselves accordingly. </p>
<p>UIImageView will need its image to have a rendering mode of UIImageRenderingModeAlwaysTemplate to receive the proper effect.</p>
</blockquote>
<p>翻译如下：</p>
<p><code>UIVibrancyEffect</code>的作用是放大和调整<code>UIVisualEffectView</code>内容视图的内容的颜色,让<code>UIVisualEffectView</code>的<code>contentView</code>中的内容看起来更加生动。它作为一个子视图被放置在<code>UIVisualEffectView</code>上面，去连接<code>UIBlurEffect</code>。这种效果只会影响添加到<code>UIVisualEffectView</code>的<code>contentView</code>上的内容。因为活力影响是受颜色依赖的…..</p>
<p><font color="#FF8000"><strong>我们可以看出</strong></font>：通常<code>UIVibrancyEffect</code>对象是与<code>UIBlurEffect</code>一起使用，主要用于处理在<code>UIBlurEffect</code>特效上的一些显示效果。</p>
<p>下面看看实现代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//实现模糊效果</span><br><span class="line">UIBlurEffect *blurEffrct =[UIBlurEffect effectWithStyle:UIBlurEffectStyleLight];   </span><br><span class="line">UIVibrancyEffect *vibrancyEffect = [UIVibrancyEffect effectForBlurEffect:blurEffrct];  </span><br><span class="line">UIVisualEffectView *visualEffectView = [[UIVisualEffectView alloc]initWithEffect:vibrancyEffect];</span><br><span class="line">// visualEffectView.backgroundColor = [ UIColor grayColor ];</span><br><span class="line">visualEffectView.contentView.frame = CGRectMake(10, 100, 300, 500);</span><br><span class="line">[self.view addSubview:visualEffectView];</span><br></pre></td></tr></table></figure>
<p>下面我们往 <figure class="highlight plain"><figcaption><span>的`contentView`上添加个`view`看看效果</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>UILabel *label = [[UILabel alloc]initWithFrame:CGRectMake(10, 300, 280, 90)];<br>label.text = @”曾经撒次考试了hhhhhhhhhhhhhhh”;<br>label.textAlignment = NSTextAlignmentLeft;<br>label.font = [UIFont systemFontOfSize:30];<br>label.tintColor = [UIColor yellowColor];<br>label.numberOfLines = 0;<br>[visualEffectView.contentView addSubview:label];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">上面代码中可以看到， 我改变`Label`中`text`的颜色是使用的：`tintColor` ，这也是特别要注意的地方，文档中也有专门提出，并给出了解释：</span><br><span class="line">`Because the vibrancy effect is color dependent, subviews added to the contentView need to be tintColorDidChange aware and must be prepared to update themselves accordingly`</span><br><span class="line">所以我们使用 `label.textColor`去改变颜色是完全不起作用的。</span><br><span class="line"></span><br><span class="line">运行效果图如下：(只剪切出效果部分)</span><br><span class="line">![VisualEffect](http://blog.guohuaden.com/VisualEffect.png)</span><br><span class="line">至于颜色不是设置的`yellowColor`，我想不需要多说了吧，这就是`UIVibrancyEffect`的功能。</span><br><span class="line"></span><br><span class="line">**三、`UIVisualEffectView`类**</span><br><span class="line"></span><br><span class="line">老规矩先看文档：也是寥寥的四种，其中值得一提的是：`contentView`。这里明确告诉我们：不要直接添加子视图去`UIVisualEffectView`，而是要添加到`contentView`上。</span><br></pre></td></tr></table></figure></p>
<p>@property (nonatomic, strong, readonly) UIView <em>contentView; // Do not add subviews directly to UIVisualEffectView, use this view instead.<br>@property (nonatomic, copy, nullable) UIVisualEffect </em>effect;</p>
<ul>
<li>(instancetype)initWithEffect:(nullable UIVisualEffect *)effect NS_DESIGNATED_INITIALIZER;</li>
<li>(nullable instancetype)initWithCoder:(NSCoder *)aDecoder NS_DESIGNATED_INITIALIZER;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">这里我就给出一个比较完整的代码（我们看一看`UIBlurEffect`类 和 `UIVisualEffectView`类 的效果）：</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@”6.jpg”]];<br>/**</p>
<ul>
<li>模糊效果的三种风格<br>*</li>
<li>@param UIBlurEffectStyle<br>UIBlurEffectStyleExtraLight,//额外亮度，（高亮风格）<br>UIBlurEffectStyleLight,//亮风格<br>UIBlurEffectStyleDark//暗风格<br><em>
</em>/<br>//实现模糊效果<br>UIBlurEffect <em>blurEffrct =[UIBlurEffect effectWithStyle:UIBlurEffectStyleLight];<br>//毛玻璃视图<br>UIVisualEffectView </em>visualEffectView = [[UIVisualEffectView alloc]initWithEffect:blurEffrct];<br>visualEffectView.frame = CGRectMake(60, 100, 300, 500);<br>visualEffectView.alpha = 0.9;<br>[self.view addSubview:visualEffectView];<br><code>`</code></li>
</ul>
<p>看看效果图是不是你想要的：<br><img src="http://blog.guohuaden.com/BlurEffect.png" alt="BlurEffect"><br>关于iOS8之前的实现，可以去github上看看一些封装库。有很多不错的三方库不错，这里就不列出了。</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/iOS/">iOS</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/毛玻璃效果/">毛玻璃效果</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2021 Wheat
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'GTM-NHB73SK', 'auto');
    ga('send', 'pageview');

</script>

    
<script>
    var _hmt = _hmt || [];
    ( function () {
        var hm = document.createElement( "script" );
        hm.src = "https://hm.baidu.com/hm.js?ae05530a6a007cdb8063cf611691cc3e";
        var s = document.getElementsByTagName( "script" )[ 0 ];
        s.parentNode.insertBefore( hm, s );
    } )();
</script>

  </div>
</div>
</body>
</html>